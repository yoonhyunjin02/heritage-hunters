/* ================= Map Page (Full-bleed) ================= */

/* --- Root tokens --- */
:root {
  --panel-w: 22.5rem;
  --radius-lg: 16px;
  --radius-full: 999px;
  --shadow-md: 0 8px 24px rgba(0,0,0,.06);
  --border: 1px solid var(--gray-200);
  --site-header-h: 64px;
  --toolbar-h: 56px;

  /* 사이드 네비 폭 (240px -> 300px) */
  --nav-w: 300px;
}

/* ---------- 지도 전용 상단 툴바(헤더 바로 밑) ---------- */
.map-toolbar {
  position: static;
  height: var(--toolbar-h);
  display: flex;
  align-items: center;
  gap: .75rem;
  padding: 0 1rem;
  background: var(--gray-000);
  border-bottom: 1px solid var(--gray-200);
  backdrop-filter: saturate(150%) blur(6px);
  z-index: auto;
}
.toolbar-left { display: flex; align-items: center; gap: .75rem; }
.toolbar-right { margin-left: auto; display: flex; align-items: center; }

/* 제목 = 필터 버튼 */
.map-title-as-filter {
  display: flex; align-items: center; gap: .5rem;
  font-size: 1.125rem; font-weight: 800; letter-spacing: -.02em;
  padding: .5rem .875rem;
  border-radius: var(--radius-full);
  border: var(--border);
  background: var(--gray-000);
  cursor: pointer;
}
.map-title-as-filter .chev { transition: transform .15s ease; opacity: .7; }

/* 검색 */
.toolbar-search { position: relative; width: min(32rem, 60vw); }
.toolbar-search input {
  width: 100%; height: 2.5rem;
  border-radius: var(--radius-full);
  border: var(--border);
  background: var(--gray-100);
  padding: 0 2.5rem 0 1rem;
  font-size: .9375rem; color: var(--gray-900); outline: none;
}
.toolbar-search input::placeholder { color: var(--gray-600); }
.toolbar-search input:focus { border-color: var(--purple-400); }
.toolbar-search .search-icon {
  position: absolute; right: .75rem; top: 50%;
  transform: translateY(-50%); opacity: .7;
}

/* 제목 아래 드롭다운 패널 */
.filter-panel {
  position: absolute;
  left: 0; top: calc(100% + .5rem);
  width: 22rem; padding: .75rem;
  border: var(--border); border-radius: 12px;
  background: var(--gray-000); box-shadow: var(--shadow-md);
  z-index: 2000;
}

/* 메뉴 아이템 */
.menu-item {
  width: 100%; text-align: left;
  padding: .625rem .75rem;
  border-radius: .5rem;
  border: 1px solid transparent;
  background: transparent;
  font-size: .9375rem;
  cursor: pointer;
}
.menu-item:hover { background: var(--gray-050); }
.menu-item[aria-checked="true"] {
  border-color: var(--gray-300);
  background: var(--gray-100);
  font-weight: 700;
}

/* ---------- 본문 레이아웃 ---------- */
.map-root {
  width: 100%;
  padding: .75rem 1rem 1rem;
  display: grid;
  grid-template-columns: 1fr; /* 기본: 지도만 */
  gap: .75rem;
  min-height: calc(100dvh - (var(--site-header-h) + var(--toolbar-h)));
  background: var(--gray-050);
}
.map-root.nav-open {
  grid-template-columns: var(--nav-w) 1fr; /* 네비 + 지도 */
}

/* 좌측 패널(선택) */
.map-root:has(.side-panel) { grid-template-columns: var(--panel-w) 1fr; gap: 1rem; }
.side-panel {
  background: var(--gray-000);
  border: var(--border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-md);
  padding: 1rem;
  display: flex; flex-direction: column;
  min-height: 0;
}
.list { margin-top: .25rem; border-top: var(--border); overflow: auto; padding-right: .25rem; }
.card {
  display: block; width: 100%; text-align: left;
  border: 0; border-bottom: var(--border);
  background: transparent; padding: .875rem .25rem; cursor: pointer;
}
.card:hover { background: var(--gray-050); }
.card .name { font-weight: 700; margin-bottom: .25rem; color: var(--gray-900); }
.card .addr { font-size: .8125rem; color: var(--gray-700); margin-bottom: .375rem; }
.card .desc { font-size: .8125rem; color: var(--gray-800); line-height: 1.45; white-space: pre-line; }

/* 지도 영역 */
.map-area { position: relative; }
#map {
  width: 100%;
  height: calc(100dvh - (var(--site-header-h) + var(--toolbar-h)) - 1.5rem);
  min-height: 24rem;
  border-radius: var(--radius-lg);
  border: var(--border);
  box-shadow: var(--shadow-md);
  background: var(--gray-100);
}
.map-area, #map { position: relative; z-index: 0; }

/* 세그먼트 버튼 */
.segmented {
  display: inline-flex; padding: .25rem; gap: .25rem;
  border: var(--border); border-radius: 999px; background: var(--gray-000);
}
.seg-btn {
  padding: .4rem .9rem; border: 0; border-radius: 999px; cursor: pointer;
  font-size: .9rem; color: var(--gray-700); background: transparent;
}
.seg-btn[aria-pressed="true"] {
  background: var(--gray-100); color: var(--gray-900); font-weight: 700;
  box-shadow: inset 0 0 0 1px var(--gray-200);
}

/* 햄버거 버튼 */
.hamburger-btn {
  border: none; background: transparent; padding: .4rem;
  cursor: pointer; display: flex; align-items: center;
}
.hamburger-btn img { width: 24px; height: 24px; }

/* 사이드 네비 */
.side-nav {
  display: none; /* 1열일 때 감춤 */
  background: var(--gray-000);
  border: var(--border);
  border-radius: 12px;
  box-shadow: var(--shadow-md);
  padding: 1rem 1rem 1.25rem;
  min-height: 0;
  overflow: auto;
}
.map-root.nav-open .side-nav { display: block; }

.side-nav ul { list-style: none; padding: 0; margin: 0; }
.side-nav li { margin-bottom: 1rem; display: flex; align-items: center; gap: .5rem; }
.side-nav li img { width: 16px; height: 16px; opacity: .8; }
.side-nav a { text-decoration: none; color: var(--gray-900); font-weight: 600; line-height: 1.3; }

/* --- Legend (범례) --- */
.legend { margin-top: 14px; }
.legend-title { font-size: 14px; font-weight: 700; margin: 8px 0; }

.legend-list {
  list-style: none;
  padding: 0; margin: 0;
  display: flex; flex-direction: column; gap: 8px;
  font-size: 13px; color: #374151;
}

.legend-item { display: flex; align-items: center; gap: 8px; }
.legend-divider { border: none; height: 1px; background: #e5e7eb; margin: 6px 0; }

.legend-icon { display: inline-block; width: 18px; height: 18px; }
/* location.svg 색상 필터 */
.legend-museum  { filter: invert(31%) sepia(95%) saturate(2140%) hue-rotate(206deg) brightness(91%) contrast(89%); } /* 파랑 */
.legend-heritage{ filter: invert(22%) sepia(94%) saturate(4567%) hue-rotate(353deg) brightness(89%) contrast(85%); } /* 빨강 */

.legend-note { display: flex; align-items: center; gap: 6px; color: #6b7280; }
.legend-footnote { color: #6b7280; font-size: 12px; margin-top: 2px; }

/* 클러스터 샘플 */
.cluster-swatch {
  display: inline-grid;
  place-items: center;
  width: 24px;
  height: 24px;
  border-radius: 9999px;
  color: #fff;
  font-size: 12px;
  font-weight: 700;
}

/* 색상별 스타일 */
.cluster-swatch-blue {
  background: radial-gradient(closest-side, rgba(37,99,235,.15), rgba(37,99,235,.55));
  border: 2px solid rgba(37,99,235,.9);
}

.cluster-swatch-red {
  background: radial-gradient(closest-side, rgba(220,38,38,.15), rgba(220,38,38,.55));
  border: 2px solid rgba(220,38,38,.9);
}

/* ---------- 반응형 (미디어 쿼리는 항상 맨 아래) ---------- */
@media (max-width: 1100px) {
  .toolbar-search { width: min(24rem, 60vw); }
}

@media (max-width: 900px) {
  :root { --nav-w: 260px; } /* 좁은 화면에선 살짝 줄여 고정 */
  .map-root { grid-template-columns: 1fr; }
  .side-panel { order: 2; }
  .map-area { order: 1; }
  #map { height: calc(100dvh - (var(--site-header-h) + var(--toolbar-h)) - .75rem); }
}

@media (max-width: var(--bp-mobile)) {
  .map-toolbar { padding: 0 .75rem; }
  .toolbar-search { width: min(18rem, 70vw); }
  .map-root { padding: .5rem .75rem 1rem; gap: .5rem; }
  .side-panel { padding: .75rem; }
}

/* Google Maps InfoWindow 커스텀 */
.gm-style .gm-style-iw {
  font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
  font-size: 13px;
  line-height: 1.45;
  max-width: 240px;
}
.gm-style .gm-style-iw h3, .gm-style .gm-style-iw .iw-title {
  margin: 0 0 4px;
  font-size: 14px;
  font-weight: 700;
  color: #111827;
}
.gm-style .gm-style-iw p, .gm-style .gm-style-iw .iw-sub {
  margin: 0;
  color: #6b7280;
  font-size: 12px;
}
.gm-style-iw button.gm-ui-hover-effect {
  top: 6px !important;
  right: 6px !important;
}

/* =========================================================
   Keyboard focus ring (접근성) — 디자인 변화 없이 추가
   - 마우스 사용 시엔 보이지 않도록 :focus-visible만 사용
   - outline은 레이아웃에 영향 없음
   ========================================================= */
.card:focus { outline: none; } /* 기존 스타일 보장 */
.card:focus-visible {
  outline: 2px solid var(--purple-400);
  outline-offset: 2px;
}

.seg-btn:focus { outline: none; }
.seg-btn:focus-visible {
  outline: 2px solid var(--purple-400);
  outline-offset: 2px;
  border-radius: 999px; /* 기존 pill 형태 유지 */
}

.hamburger-btn:focus { outline: none; }
.hamburger-btn:focus-visible {
  outline: 2px solid var(--purple-400);
  outline-offset: 2px;
  border-radius: 8px; /* 버튼 모양 유지 */
}

.side-nav a:focus { outline: none; }
.side-nav a:focus-visible {
  outline: 2px solid var(--purple-400);
  outline-offset: 2px;
  border-radius: 6px; /* 링크 주변만 강조 */
}

/* (옵션) 범례 아이템 키보드 포커스 */
.legend-item:focus { outline: none; }
.legend-item:focus-visible {
  outline: 2px solid var(--purple-400);
  outline-offset: 2px;
  border-radius: 8px;
}
